layui.use(["layer","jquery","form","upload"],function(){var i=layui.form,n=parent.layer===undefined?layui.layer:top.layer,t=layui.jquery,r=layui.upload,u=r.render({elem:"#upload",url:"/Message/TemplateType/Import",method:"post",accept:"json,js",auto:!1,bindAction:"#submit",data:{language:function(){return t("#language").val()}},size:2048,multiple:!1,number:1,field:"formFile",drag:!1,exts:"json|js",acceptMime:"application/x-javascript,text/javascript,application/json",done:function(i,r){return(n.closeAll("loading"),!i.success)?(n.alert("操作失败:"+i.msg,{title:"错误",icon:5}),!1):(n.open({type:2,title:"预览 "+i.data.templateName,content:"/Message/TemplateType/TemplatePreview?id="+i.data.templateId+"&loadInCache=true",skin:"layui-layer-lan",area:["900px","820px"],offset:"auto",shade:.3,maxmin:!0,btn:["保存","关闭"],yes:function(r){t.get("/Message/Template/Add",{id:i.data.templateId},function(t){return t.success?(n.msg("操作成功"),n.close(r),!1):(n.alert("操作失败:"+t.msg,{title:"错误",icon:5}),!1)})},btn2:function(r){t.get("/Message/Template/RealDelete",{id:i.data.templateId},function(t){return t.success?(n.close(r),!1):(n.alert("操作失败:"+t.msg,{title:"错误",icon:5}),!1)})},cancel:function(){t.get("/Message/Template/RealDelete",{id:i.data.templateId},function(t){return t.success?(n.close(r),!1):(n.alert("操作失败:"+t.msg,{title:"错误",icon:5}),!1)})}}),!1)},error:function(){n.closeAll("loading")},choose:function(n){n.preview(function(n,i){t("#lbFileName").text(i.name)})},allDone:function(){},before:function(){n.load(3)}});i.on("submit(form)",function(){return t("#lbFileName").text()||n.alert("请上传词条文件",{icon:5,anim:6}),!1});t("#close").click(function(){var n=parent.layer.getFrameIndex(window.name);parent.layer.close(n)})});