layui.use(["layer","jquery","form"],function(){var u=layui.form,n=parent.layer===undefined?layui.layer:top.layer,t=layui.jquery,f=CodeMirror.fromTextArea(document.getElementById("dataJson"),{mode:"application/json",lineNumbers:!0,theme:"dracula",lineWrapping:!0,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],matchBrackets:!0}),r=CodeMirror.fromTextArea(document.getElementById("templateTitle"),{mode:"text/html",lineNumbers:!0,theme:"dracula",lineWrapping:!0,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],matchBrackets:!0}),i;r.setSize("100%","50px");i=CodeMirror.fromTextArea(document.getElementById("templateBody"),{mode:"text/html",lineNumbers:!0,theme:"dracula",lineWrapping:!0,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],matchBrackets:!0});i.setSize("100%","600px");u.on("submit(form)",function(u){var o=f.getValue(),s=r.getValue(),e=i.getValue();return e?(u.field.dataJson=o,u.field.templateTitle=s,u.field.templateBody=e,t.post("/Message/TemplateType/Edit",u.field,function(i){return i.success?(n.msg("操作成功",{icon:6}),top.refreshParent(),t("#close").click(),!1):(n.alert("操作失败:"+i.msg,{title:"错误",icon:5}),!1)}),!1):(n.msg("必填项不能为空",{icon:5,anim:6}),!1)});t("#close").click(function(){var n=parent.layer.getFrameIndex(window.name);parent.layer.close(n)})});