layui.config({base:"/module/"}).extend({treetable:"treetable-lay/treetable"}).use(["form","layer","table","treetable","laytpl"],function(){var t=layui.jquery,n=parent.layer===undefined?layui.layer:top.layer,i=layui.table,r=top.initFilter(window);i.on("toolbar(table)",function(i){switch(i.event){case"delete":if(i.config.data.length<1)return n.msg("请查询您所需要删除的缓存"),!1;n.confirm("确认要删除查询出的缓存吗？",{icon:3,title:"提示"},function(r){var f,u,e;n.close(r);f=n.load(0,{shade:[.3,"#fff"]});u=[];i.config.data.forEach(function(n){n.key&&u.push(n.key)});e=u.join(",");t.post("/DevOps/trackInfoNumbersDelete/DeleteKeys",{keys:e},function(i){if(n.close(f),!i.success)return n.alert("操作失败:"+i.msg,{title:"错误",icon:5}),!1;n.msg("操作成功");t("#search").click()})})}return!1});t("#search").click(function(){var i=t("#areaTrackNos").val().replace(/\n/g,","),r;if(t.trim(i)=="")return n.msg("请输入单号"),!1;t("#trackNos").val(i);top.changeUrlParam(window);r=n.load(0,{shade:[.3,"#fff"]});layui.treetable.render({id:"table",method:"get",toolbar:"#toolbar",treeColIndex:4,treeSpid:-1,treeIdName:"id",treePidName:"parentId",treeDefaultClose:!1,treeLinkage:!0,elem:"#table",url:"/DevOps/trackInfoNumbersDelete/GetListTrackCache?trackNos="+i,page:!1,cols:[[{type:"numbers"},{type:"checkbox",hide:!0},{field:"id",title:"ID",hide:!0},{field:"parentId",title:"父级ID",hide:!0},{field:"key",title:"缓存键",minWidth:200}]],done:function(t){n.close(r);t.Count==-1&&n.alert("操作失败:未知的异常，请联系管理员",{title:"错误",icon:5})}})});t("#trackNos").val()!=""&&(t("#areaTrackNos").val(t("#trackNos").val().replace(/,/g,"\n")),t("#search").click())});