layui.use(["form","layer","table","laytpl","jquery"],function(){var u=layui.form,n=parent.layer===undefined?layui.layer:top.layer,i=layui.jquery,f=layui.laytpl,r=layui.table,t=top.initFilter(window);r.render({elem:"#managerTable",method:"post",url:"/Admin/Manager/GetPageData/",height:"full-"+t.top,cellMinWidth:90,toolbar:"#toolbar",defaultToolbar:["filter","exports","print"],cols:[[{type:"numbers"},{type:"radio"},{field:"id",title:"管理员ID",hide:!0},{field:"account",title:"账号"},{field:"nickName",title:"姓名"},{field:"isLock",title:"是否启用",templet:"#isLock",width:100},{field:"avatar",title:"头像",width:70,templet:"#avatar"},{field:"email",title:"邮箱",width:160},{field:"remark",title:"备注"},{field:"createdTime",title:"创建时间",width:160},{field:"lastLoginTime",title:"最后登陆时间",width:160},{field:"updatedTime",title:"更新时间",width:160}]],page:{limit:t.limit?t.limit:10,limits:[10,15,20,25],curr:t.page?t.page:1},where:{nickName:t.nickName,account:t.account},done:function(n,t){i("#page").val(t);i("#limit").val(this.limit);top.changeUrlParam(window)}});r.on("toolbar(managerTable)",function(t){var u=r.checkStatus(t.config.id),f,e,o,s,h,c;switch(t.event){case"add":n.open({type:2,title:"添加用户",content:"/Admin/Manager/Add?iframeName="+window.name,skin:"layui-layer-lan",area:["500px","580px"],offset:"auto",shade:.3});break;case"update":if(u.data.length!==1){n.msg("请先选择有且仅有一个用户");return}f=u.data[0].nickName;e=u.data[0].id;n.open({type:2,title:"编辑用户 "+f,content:"/Admin/Manager/Edit?iframeName="+window.name+"&id="+e,skin:"layui-layer-lan",area:["500px","450px"],offset:"auto",shade:.3});break;case"set":if(u.data.length!==1){n.msg("请先选择有且仅有一个用户");return}o=u.data[0].nickName;s=u.data[0].id;n.open({type:2,title:"设置管理员角色 "+o,content:"/Admin/Manager/GetRoleList?userId="+s,skin:"layui-layer-lan",area:["700px","600px"],offset:"auto",shade:.3});break;case"delete":if(u.data.length!==1){n.msg("请先选择有且仅有一个用户");return}h=u.data[0].nickName;c=u.data[0].id;n.confirm("您确定要删除 "+h+" 用户吗?",{icon:3,title:"警告"},function(t){i.post("/Admin/Manager/Delete",{id:c},function(i){return i.success?(n.msg("操作成功"),r.reload("managerTable"),n.close(t),!1):(n.alert("操作失败:"+i.msg,{title:"错误",icon:5}),!1)})})}});i("#search").on("click",function(){var n=i("#nickName").val(),t=i("#account").val();return r.reload("managerTable",{page:{curr:1},where:{nickName:n,account:t}}),!0})});