layui.use(["layer","jquery","form","element","table","laytpl","laydate","formSelects"],function(){function o(n,t){return n.map(n=>n[t])}var s=layui.laydate,r=layui.table,t=layui.formSelects,u=layui.form,f=parent.layer===undefined?layui.layer:top.layer,n=layui.jquery;let i=JSON.parse(n("#hRules").val());f.rules=i;let e=n("#hProductId").val();n.ajax({url:"/pay/activity/getproducts",data:{},dataType:"json",success:function(i){var u,r,f;n("#productId").empty();i.success?(n("#productId").append(new Option("请选择","")),n.each(i.data,function(t,i){t==e?n("#productId").append(new Option(i,t,!1,!0)):n("#productId").append(new Option(i,t))})):n("#productId").append(new Option("暂无数据",""));layui.form.render("select");u=JSON.parse(n("#hSkuCodes").val());r=[];n.each(u,function(n,t){var t={name:t,value:n+1};r.push(t)});t.data("skuCodes","local",{arr:r});f=o(r,"value");t.value("skuCodes",f)}});n("#close").click(function(){var n=parent.layer.getFrameIndex(window.name);parent.layer.close(n)});r.render({elem:"#activityRule",data:i,cols:[[{field:"id",title:"顺序"},{field:"c",title:"货币",templet:function(n){return n.c=="0"?"未知":n.c=="1"?"人民币":n.c=="2"?"美元":void 0}},{field:"t",title:"阈值"},{field:"d",title:"优惠"}]]});u.on("switch(locked)",function(t){var i=t.elem.value;i==="true"?(t.elem.value="false",n(t.elem).removeAttr("checked")):t.elem.value="true"})});