layui.use(["form","layer","table","laytpl"],function(){var u=layui.form,r=parent.layer===undefined?layui.layer:top.layer,t=layui.jquery,f=layui.laytpl,i=layui.table,n=top.initFilter(window);i.render({elem:"#table",method:"post",url:"/Pay/Invoice/GetPageData",height:"full-"+n.top,cellMinWidth:60,toolbar:"#toolbar",defaultToolbar:["filter","exports","print"],cols:[[{type:"numbers"},{field:"userId",title:"用户ID",templet:function(n){return n.userId=="0"?n.userId:'<a class="layui-table-link" lay-event="viewUser" lay-filter="viewUser">'+n.userId+"<\/a>"},width:180},{field:"userEmail",title:"注册邮箱"},{field:"invoiceType",title:"发票类型",width:150},{field:"companyName",title:"公司名称"},{field:"taxNo",title:"税号"},{field:"contact",title:"联系人",width:140},{field:"createAt",title:"创建时间",width:160},{field:"updateAt",title:"更新时间",width:160},{field:"operate",title:"操作",templet:function(n){return'<a class="layui-btn layui-btn layui-btn-xs" lay-event="view" lay-filter="view" value="'+n.invoiceId+'">详情<\/a><a class="layui-btn layui-btn layui-btn-xs" lay-event="edit" lay-filter="edit" value="'+n.invoiceId+'">编辑<\/a>'},width:110}]],page:{limit:n.limit?n.limit:10,limits:[10,15,20,25],curr:n.page?n.page:1},where:{userEmail:n.userEmail,status:n.status},done:function(n,i){t("#page").val(i);t("#limit").val(this.limit);top.changeUrlParam(window)}});t("#search").on("click",function(){var n=decodeURIComponent(t("form").serialize(),!0).split("&"),u={};for(var r in n)n.hasOwnProperty(r)&&(u[n[r].split("=")[0]]=n[r].split("=")[1].replace(/\+/g," "));return i.reload("table",{page:{curr:1},where:{userEmail:u.userEmail}}),!0});i.on("toolbar(table)",function(n){switch(n.event){case"add":r.open({type:2,title:"添加发票资料",content:"/Pay/Invoice/Add?iframeName="+window.name,skin:"layui-layer-lan",area:["800px","780px"],offset:"auto",shade:.3,maxmin:!0})}});i.on("tool(table)",function(n){var t=JSON.parse(window.top.sessionStorage.getItem("curmenu"));switch(n.event){case"view":window.top.addMyTab("/pay/invoice/view?id="+n.data.invoiceId,"查看发票资料",t.topMenuName,t.leftMenuName);break;case"edit":r.open({type:2,title:"修改发票资料",content:"/Pay/Invoice/Edit?iframeName="+window.name+"&id="+n.data.invoiceId,skin:"layui-layer-lan",area:["800px","780px"],offset:"auto",shade:.3,maxmin:!0});break;case"viewUser":window.top.addMyTab("/business/user/detail?userId="+n.data.userId,"用户详情 "+n.data.userEmail,"systemcenter",t.leftMenuName)}})});