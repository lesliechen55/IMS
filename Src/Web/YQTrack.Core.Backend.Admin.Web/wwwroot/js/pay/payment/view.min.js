layui.use(["form","layer","table","laytpl"],function(){var n=parent.layer===undefined?layui.layer:top.layer,i=layui.jquery,r=layui.laytpl,t=layui.table;t.init("detail",{cellMinWidth:60});t.init("log",{cellMinWidth:60});t.on("tool(detail)",function(t){var f=t.data,u=t.event,e=t.tr,r;u==="refund"?n.prompt({formType:2,title:"确认要退款吗？",area:["500px","220px"]},function(r,u){if(!r)return n.msg("请输入原因"),!1;var f=n.load({time:1e4});i.post("/Pay/Payment/Refund",{orderId:t.data.orderId,reason:r},function(t){return(n.close(f),!t.success)?(n.alert("操作失败:"+t.msg,{title:"错误",icon:5}),!1):(n.msg("操作成功"),n.close(u),window.location.reload(),!1)})}):u==="viewOrder"&&(r=JSON.parse(window.top.sessionStorage.getItem("curmenu")),window.top.addMyTab("/pay/purchaseorder/viewproduct?id="+t.data.orderId,"订单 "+t.data.orderName,r.topMenuName,r.leftMenuName))})});